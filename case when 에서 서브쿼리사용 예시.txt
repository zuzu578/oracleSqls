SELECT *
FROM (
SELECT A.MAIN_CONTENT_ID
,A.CONTENT_TYPE_CD
,A.UP_MAIN_CONTENT_ID

,CASE CONTENT_TYPE_CD
WHEN 'MOVIE' THEN B.TITLE
WHEN 'VOD_MULTI' THEN B.TITLE
WHEN 'STORY' THEN C.TITLE
WHEN 'STORY_HEAD' THEN C.TITLE
WHEN 'DB_FESTIVAL' THEN D.NAME_KOR
WHEN 'DB_THEME' THEN E.KEYWORDNAME
WHEN 'DB_LIST' THEN F.MOVIELIST_NAME
WHEN 'VOD_PLAN' THEN G.TITLE
WHEN 'THEATER' THEN I.TITLE
WHEN 'ARCHIVES_CONTENT' THEN J.SUBJECT
-- WHEN 'COLLECTION' THEN ta.COL_NAME
ELSE A.TITLE
END
AS TITLE
,CASE CONTENT_TYPE_CD
WHEN 'DB_LIST' THEN
(SELECT (SELECT MOVIELIST_NAME
FROM MOVIELIST
WHERE MOVIELIST_NO = SUBSTR(X.MOVIELIST_NO, 0, 2))
FROM MOVIELIST X
WHERE MOVIELIST_ID = A.KEY1)
ELSE
A.SUB_TITLE
END

,CASE CONTENT_TYPE_CD
WHEN 'COLLECTION' THEN
colDepth
ELSE
colDepth
END
AS col_depth

,CASE CONTENT_TYPE_CD
WHEN 'COLLECTION' THEN
cCollectionKofaGroupTitle
ELSE
cCollectionKofaGroupTitle
END
AS cCollectionKofaGroupTitle

,CASE CONTENT_TYPE_CD
WHEN 'COLLECTION' THEN
COL_ID
ELSE
COL_ID
END
AS COL_ID

,CASE CONTENT_TYPE_CD
WHEN 'COLLECTION' THEN
colName
ELSE
colName
END
AS colName

,CASE CONTENT_TYPE_CD
WHEN 'COLLECTION' THEN
useYn
ELSE
useYn
END
AS useYn
,CASE CONTENT_TYPE_CD
WHEN 'COLLECTION' THEN
adjustDate
ELSE
adjustDate
END
AS adjustDate
,A.CONTENT_DESC
,A.URL
,A.SORT_NO
,A.ACTIVE_YN
,A.KEY1
,A.KEY2
,A.KEY3
,A.FILE_ALT
,A.ORG_FILE_NAME
,A.FILE_NAME
,B.DIRECTOR AS MOVIE_DIRECTOR
,B.PROD_YEAR AS MOVEI_PRODYEAR
,C.WRITER AS STORY_WRITER
,NVL(H.RUNTIME, 0) AS MULTI_RUN_MIN
,NVL(H.SECONDS, 0) AS MULTI_RUN_SEC
,CASE H.MSCREEN_CLSS
WHEN '1' THEN B.TITLE || ' ' || H.TITLE_ETC || ' 예고편'
WHEN '2' THEN B.TITLE || ' ' || H.TITLE_ETC
END
AS MULTI_TITLE
,J.TARGET_NAME
FROM TB_MAIN_CONTENT A
LEFT OUTER JOIN MOVIE_SE B
ON A.KEY1 = B.MOVIE_ID
AND A.KEY2 = B.MOVIE_SEQ
LEFT OUTER JOIN (SELECT A.STORY_SEQ
,A.TITLE
,A.WRITER_SEQ
,B.WRITER
FROM TB_MOVIE_STORY A INNER JOIN TBL_WRITER B ON A.WRITER_SEQ = B.SEQ) C
ON A.KEY1 = TO_CHAR(C.STORY_SEQ)
LEFT OUTER JOIN TBLFESTIVAL D ON A.KEY1 = TO_CHAR(D.FE_NO)
LEFT OUTER JOIN KEYWORD_EXPERT E ON A.KEY1 = TO_CHAR(E.IDX)
LEFT OUTER JOIN MOVIELIST F ON A.KEY1 = TO_CHAR(F.MOVIELIST_ID)
LEFT OUTER JOIN TB_PLAN G ON A.KEY1 = TO_CHAR(G.PLAN_SEQ)
LEFT OUTER JOIN MULTI_NEW H ON A.KEY3 = TO_CHAR(H.MUL_ID)
LEFT OUTER JOIN OTHER I ON A.KEY1 = TO_CHAR(I.OTHER_ID)
LEFT OUTER JOIN TB_ONLINE_ARCHIVES J ON A.KEY1 = TO_CHAR(J.ARCHIVES_SEQ)
LEFT OUTER JOIN (SELECT
TA.COL_ID,
A1.COL_NAME as cCollectionKofaGroupTitle
, TA.COL_NAME as colName
,A1.ADJUST_DATE AS adjustDate
,B1.COL_DEPTH AS colDepth
,A1.USE_YN AS useYn

FROM KMDB.KMDB_COLLECTIONS A1
INNER JOIN KMDB.KMDB_COLLECTIONS_UPPER B1 ON A1.COL_ID = B1.UPPER_COL_ID
LEFT OUTER JOIN (SELECT COL_ID, COL_NAME FROM KMDB.KMDB_COLLECTIONS) TA ON to_char(TA.COL_ID) = B1.COL_ID) TA1 ON A.key1 = to_char(TA1.COL_ID)
WHERE 1=1
AND colDepth = 2

) A